<div class="confesion-card" id="conf-{{ conf._id }}" 
      style="background: {{ conf.color or '#ffffff' }}; 
            color: {{ '#262626' if (conf.color == '#ffffff' or not conf.color) else '#ffffff' }}">
    
    <div class="card-header">
        <div class="user-info">
            <h5 class="user-name">{{ conf.usuario or 'Anónimo' }}</h5>
            <p class="timestamp">{{ conf.fecha.strftime("%d/%m/%Y %H:%M") if conf.fecha else '' }}</p>
        </div>
        {% if conf.usuario == alias %}
        <button class="delete-btn" title="Eliminar confesión">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="feather feather-x">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        {% endif %}
    </div>

    <p class="confesion-text">{{ conf.texto }}</p>

    {% if conf.imagen %}
    <div class="conf-media-container">
        <img class="conf-image" src="{{ url_for('media', file_id=conf.imagen) }}" alt="Imagen de la confesión">
    </div>
    {% endif %}

    {% if conf.audio %}
    <div class="conf-media-container">
        <audio controls class="audio-player" preload="none">
            <source src="{{ url_for('media', file_id=conf.audio) }}" type="audio/mpeg">
            Tu navegador no soporta el elemento de audio.
        </audio>
    </div>
    {% endif %}

    <div class="card-actions">
        <div class="reacciones">
            {% for emoji, count in conf.reacciones.items() %}
            <button class="emoji-btn">{{ emoji }}<span>{{ count }}</span></button>
            {% endfor %}
        </div>
    </div>

    <div class="comentarios-container">
        <div class="comentarios-lista" id="comentarios-{{ conf._id }}">
            {% for c in conf.comentarios %}
            <div class="comentario-item">
                <span class="comentario-usuario">{{ c.usuario or 'Anónimo' }}:</span>
                <span class="comentario-texto">{{ c.texto }}</span>
            </div>
            {% endfor %}
        </div>
        
        <div class="comentario-box">
            <input type="text" placeholder="Añade un comentario..." class="comentario-input">
            <button class="enviar-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-send"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
            </button>
        </div>
    </div>
</div>